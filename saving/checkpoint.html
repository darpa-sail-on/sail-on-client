<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

      <title>Saving And Restoring Attributes of Algorithm</title>
    
      <link rel="stylesheet" href="../_static/pygments.css">
      <link rel="stylesheet" href="../_static/theme.css">
      <link rel="stylesheet" href="../_static/sphinx_press_theme.css">
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/css/theme.css " type="text/css" />
      
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>

      
      <script src="../_static/theme-vendors.js"></script>
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="Checkpoint API" href="checkpoint_api.html" />
  <link rel="prev" title="Saving And Restoring Features for Algorithm" href="features.html" /> 
  </head>

  <body>
    <div id="app" class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">Sail-On Client</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">

  
    <div class="nav-item">
      <a href="../index.html#user-guide"
         class="nav-link ">
         user guide
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#empirical-protocols"
         class="nav-link ">
         empirical protocols
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#interfaces"
         class="nav-link ">
         interfaces
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#metrics"
         class="nav-link ">
         metrics
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#feedback"
         class="nav-link ">
         feedback
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#plugins"
         class="nav-link ">
         plugins
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#saving-and-restoring-models"
         class="nav-link  router-link-active">
         saving and restoring models
      </a>
    </div>
  



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            

  
    <div class="nav-item">
      <a href="../index.html#user-guide"
         class="nav-link ">
         user guide
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#empirical-protocols"
         class="nav-link ">
         empirical protocols
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#interfaces"
         class="nav-link ">
         interfaces
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#metrics"
         class="nav-link ">
         metrics
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#feedback"
         class="nav-link ">
         feedback
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#plugins"
         class="nav-link ">
         plugins
      </a>
    </div>
  
    <div class="nav-item">
      <a href="../index.html#saving-and-restoring-models"
         class="nav-link  router-link-active">
         saving and restoring models
      </a>
    </div>
  



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#user-guide">user guide</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../user/install.html" class="reference internal ">Installation</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#empirical-protocols">empirical protocols</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../protocols/ond.html" class="reference internal ">Open World Novelty Detection (OND)</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../protocols/condda.html" class="reference internal ">Continuous Open-set Novelty Detection, Discovery, Adaptation (CONDDA)</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../protocols/protocol_api.html" class="reference internal ">Protocol API</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#interfaces">interfaces</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../interfaces/interface.html" class="reference internal ">Interface</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../interfaces/interface_api.html" class="reference internal ">Interface API</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#metrics">metrics</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../metrics/metric_formulation.html" class="reference internal ">Program Metrics</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../metrics/metric_api.html" class="reference internal ">Metric API</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#feedback">feedback</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../feedback/feedback.html" class="reference internal ">Feedback</a>

            
          </li>

        
          <li class="toctree-l1 "><a href="../feedback/feedback_api.html" class="reference internal ">Feedback API</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#plugins">plugins</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 "><a href="../plugins/plugins.html" class="reference internal ">Plugins</a>

            
          </li>

        
      </ul>
    </div>
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#saving-and-restoring-models">saving and restoring models</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 "><a href="features.html" class="reference internal ">Saving And Restoring Features for Algorithm</a>

            
          </li>

        
          <li class="toctree-l1 current"><a href="#" class="reference internal current">Saving And Restoring Attributes of Algorithm</a>

            
              <ul>
                
                  <li class="toctree-l2"><a href="#introduction" class="reference internal">Introduction</a></li>
                
                  <li class="toctree-l2"><a href="#sample-detector-adapter-and-configuration-parameters" class="reference internal">Sample Detector, Adapter and Configuration Parameters</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 "><a href="checkpoint_api.html" class="reference internal ">Checkpoint API</a>

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
    <li>Saving And Restoring Attributes of Algorithm</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="features.html"
       title="previous chapter">← Saving And Restoring Features for Algorithm</a>
  </li>
  <li class="next">
    <a href="checkpoint_api.html"
       title="next chapter">Checkpoint API →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main">
            
  <section id="saving-and-restoring-attributes-of-algorithm">
<h1>Saving And Restoring Attributes of Algorithm<a class="headerlink" href="#saving-and-restoring-attributes-of-algorithm" title="Permalink to this headline">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>We rely on <code class="code docutils literal notranslate"><span class="pre">Checkpoint</span></code> mixin to save and restore attribute of an algorithm.
The mixin can be added to an adaptor associated with an algorithm to provide
<code class="code docutils literal notranslate"><span class="pre">save_attributes</span></code> and <code class="code docutils literal notranslate"><span class="pre">restore_attributes</span></code> function. These functions
can be used with configuration options to save and restore states in a pickle
file. Refer to <cite>ond_12_with_rd_nd_save.json</cite> and <cite>ond_12_with_rd_nd_restore.json</cite>
configurations on the <a class="reference external" href="https://gitlab.kitware.com/darpa-sail-on/sail-on-client/-/tree/master/config">config</a> directory for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Saving features and saving attributes were created with different use cases.
Saving features is used to save features for videos and restore them
across multiple tests. Thus the features can be extracted for a video
once and can be reused across multiple tests. We cannot guarantee this
mode of operation when checkpointing since attributes are not saved with
videos as keys. Thus checkpointing can be used to skip steps for a protocol
but it shouldn’t be used on a sequence of videos that is different from
the original sequence. This would result in undefined behavior.</p>
</div>
</section>
<section id="sample-detector-adapter-and-configuration-parameters">
<h2>Sample Detector, Adapter and Configuration Parameters<a class="headerlink" href="#sample-detector-adapter-and-configuration-parameters" title="Permalink to this headline">¶</a></h2>
<section id="sample-detector">
<h3>Sample Detector<a class="headerlink" href="#sample-detector" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="k">class</span> <span class="nc">MockDetectorWithAttributes</span><span class="p">(</span><span class="n">MockDetector</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mock Detector for testing checkpointing.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detector constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            toolset (dict): Dictionary containing parameters for the constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">MockDetector</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_feature_extraction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">:</span> <span class="n">Dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Feature extraction step for the algorithm.</span>

<span class="sd">        Args:</span>
<span class="sd">            toolset (dict): Dictionary containing parameters for different steps</span>

<span class="sd">        Return:</span>
<span class="sd">            Tuple of dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_dict</span> <span class="o">=</span> <span class="n">toolset</span><span class="p">[</span><span class="s2">&quot;dummy_dict&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_list</span> <span class="o">=</span> <span class="n">toolset</span><span class="p">[</span><span class="s2">&quot;dummy_list&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_tuple</span> <span class="o">=</span> <span class="n">toolset</span><span class="p">[</span><span class="s2">&quot;dummy_tuple&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_tensor</span> <span class="o">=</span> <span class="n">toolset</span><span class="p">[</span><span class="s2">&quot;dummy_tensor&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dummy_val</span> <span class="o">=</span> <span class="n">toolset</span><span class="p">[</span><span class="s2">&quot;dummy_val&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{},</span> <span class="p">{}</span>

</pre></div>
</div>
</section>
<section id="sample-adapter">
<h3>Sample Adapter<a class="headerlink" href="#sample-adapter" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">MockAdapterWithCheckpoint</span><span class="p">(</span><span class="n">BaseAlgorithm</span><span class="p">,</span> <span class="n">Checkpointer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mock Adapter for testing checkpointing.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Detector constructor.</span>

<span class="sd">        Args:</span>
<span class="sd">            toolset (dict): Dictionary containing parameters for the constructor</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseAlgorithm</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">)</span>
        <span class="n">Checkpointer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detector</span> <span class="o">=</span> <span class="n">MockDetectorWithAttributes</span><span class="p">(</span><span class="n">toolset</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">toolset</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">step_descriptor</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Execute method used by the protocol to run different steps.</span>

<span class="sd">        Args:</span>
<span class="sd">            toolset (dict): Dictionary containing parameters for different steps</span>
<span class="sd">            step_descriptor (str): Name of the step</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Executing </span><span class="si">{</span><span class="n">step_descriptor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">step_dict</span><span class="p">[</span><span class="n">step_descriptor</span><span class="p">](</span><span class="n">toolset</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="sample-configuration">
<h3>Sample Configuration<a class="headerlink" href="#sample-configuration" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The configuration options used for saving attributes are highlighted in the
examples below.</p>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="hll">  <span class="nt">&quot;save_attributes&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;saved_attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">      <span class="nt">&quot;feature_extraction&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;FVs&quot;</span><span class="p">,</span> <span class="s2">&quot;image_names&quot;</span><span class="p">,</span> <span class="s2">&quot;Pr&quot;</span><span class="p">,</span> <span class="s2">&quot;P_max_known&quot;</span><span class="p">]</span>
</span><span class="hll">  <span class="p">},</span>
</span><span class="hll">  <span class="nt">&quot;skip_stage&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;WorldDetection&quot;</span><span class="p">,</span> <span class="s2">&quot;NoveltyClassification&quot;</span><span class="p">,</span>
</span><span class="hll">                 <span class="s2">&quot;NoveltyAdaption&quot;</span><span class="p">,</span> <span class="s2">&quot;NoveltyCharacterization&quot;</span><span class="p">],</span>
</span><span class="hll">  <span class="nt">&quot;save_elementwise&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
</span>  <span class="nt">&quot;save_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="nt">&quot;dataset_root&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="nt">&quot;detectors&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;has_reaction_baseline&quot;</span><span class="p">:</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="hll">  <span class="nt">&quot;saved_attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class="hll">      <span class="nt">&quot;FeatureExtraction&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;FVs&quot;</span><span class="p">,</span> <span class="s2">&quot;image_names&quot;</span><span class="p">,</span> <span class="s2">&quot;Pr&quot;</span><span class="p">,</span> <span class="s2">&quot;P_max_known&quot;</span><span class="p">]</span>
</span><span class="hll">  <span class="p">},</span>
</span><span class="hll">  <span class="nt">&quot;save_elementwise&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;save_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class="hll">  <span class="nt">&quot;skip_stage&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;feature_extraction&quot;</span><span class="p">],</span>
</span><span class="hll">  <span class="nt">&quot;use_saved_attributes&quot;</span><span class="p">:</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span>
</span>  <span class="nt">&quot;dataset_root&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
  <span class="nt">&quot;detectors&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;has_reaction_baseline&quot;</span><span class="p">:</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
    <span class="nt">&quot;has_baseline&quot;</span><span class="p">:</span> <span class="s2">&quot;False&quot;</span><span class="p">,</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="features.html"
       title="previous chapter">← Saving And Restoring Features for Algorithm</a>
  </li>
  <li class="next">
    <a href="checkpoint_api.html"
       title="next chapter">Checkpoint API →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2020, Kitware INC..
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a>.
</div>
            </div>
          </div>
      </page>
    </div>
    
    
  </body>
</html>